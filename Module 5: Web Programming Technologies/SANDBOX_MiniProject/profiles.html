<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="icon" href="img/san.png" type="image/png">
    <link rel="stylesheet" href="css/styles.css">
    <title>Student Profiles</title>
</head>
<body>
    <header class="bg-dark text-white d-flex flex-wrap align-items-center p-3">
        <div class="symbol mr-3">
            <img style="height: 60px; width: 60px; margin-left: 20px;border-radius: 10px;" src="img/imm.jpg" alt="Symbol" class="img-fluid">
        </div>
        <h3 style="color: rgb(0, 0, 0); font-family: fantasy;" class="mr-auto">SANDBOX</h3>
        <nav class="navbar navbar-expand-lg navbar-light bg-dark">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a class="nav-link text-white" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="projects.html">Project Listings</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="profiles.html">Student Profiles</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="contact.html">Contact Us</a></li>
                    <li class="nav-item"><a class="nav-link text-white" href="login.html">Sign In</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <div style="border-radius: 5px; margin-left: 5px; background: white; padding: 5px; margin-top: 10px; width: 400px; border: 1px solid black;">
        <h6 style="margin-left: 10px; margin-top: 5px;"><b>Name :</b> Samruddhi Desai
            <br><b>Education: </b> Btech Computer Science Engineering
        </h6>
        <!-- <button id="show-button"><a href="port.html">ViewPort</a></button> -->
    </div>

    <main style="width: 600px;" class="container my-4">
        <h2 style="color: black;"><b>Your Projects</b></h2>
        <button class="btn btn-success mb-3" onclick="showProjectForm()">Add New Project</button>
        <div id="project-form" style="display: none;">
            <div class="card shadow mx-auto" style="max-width: 800px;">
                <div class="card-body">
                    <h3 class="card-title text-center">Project Form</h3>
                    <form id="form">
                        <div class="form-group">
                            <label for="title">Project Title:</label>
                            <input type="text" id="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="author">Author:</label>
                            <input type="text" id="author" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="technologiesUsed">Technologies Used:</label>
                            <input type="text" id="technologiesUsed" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="languageUsed">Language Used:</label>
                            <input type="text" id="languageUsed" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="imageFile">Image File:</label>
                            <input type="file" id="imageFile" class="form-control" accept="image/*" required>
                        </div>
                        <div class="form-group">
                            <label for="description">Description:</label>
                            <textarea id="description" class="form-control" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="githubLink">GitHub Link:</label>
                            <input type="url" id="githubLink" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="button" class="btn btn-secondary" onclick="hideProjectForm()">Cancel</button>
                    </form>
                </div>
            </div>
        </div>
        <h3 style="color: black;">Projects List</h3>
        <div id="projects-list"></div>
    </main>

    <footer class="bg-dark text-white text-center p-3">
        <p>&copy; 2024 Student Project Showcase. All rights reserved.</p>
        <p>Contact Us: <a href="mailto:samruddhidesai44@gmail.com">samruddhidesai44@gmail.com</a> | Samruddhi Desai</p>
    </footer>

    <script>
        let editingIndex = null;// null indicates that no project is currently being edited.

        function showProjectForm() {
            document.getElementById("project-form").style.display = "block";
        }

        function hideProjectForm() {
            document.getElementById("project-form").style.display = "none";
            document.getElementById("form").reset();
            editingIndex = null;
        }

        function loadProjects() {
            const projectsList = document.getElementById("projects-list");
            const projects = JSON.parse(localStorage.getItem("projects")) || [];

            projectsList.innerHTML = projects.map((project, index) => `
                <div class="card mb-3">
                    <img style="height:200px" src="${project.imageSrc}" class="card-img-top" alt="${project.title}">
                    <div class="card-body">
                        <h5 class="card-title">${project.title}</h5>
                        <p class="card-text">${project.description}</p>
                        <button class="btn btn-primary" onclick="editProject(${index})">Edit</button>
                        <button class="btn btn-danger" onclick="deleteProject(${index})">Delete</button>
                        <!-- <button class="btn btn-success" onclick="addDetails(${index})">Add Details</button>-->
                         <!-- <button class="btn btn-dark" onclick="toggleDetails(${index})">Show Details</button>-->
                        <div id="additional-details-${index}" style="display: none;">
                            ${project.additionalDetails ? `
                                <h6>Detail Title: ${project.additionalDetails.detailTitle}</h6>
                                <p>Author: ${project.additionalDetails.author}</p>
                                <p>Technologies Used: ${project.additionalDetails.technologiesUsed}</p>
                                <p>Language Used: ${project.additionalDetails.languageUsed}</p>
                                <img style="height:100px;" src="${project.additionalDetails.imageUrl}" alt="Detail Image">
                                <p>Description: ${project.additionalDetails.description}</p>
                                <p>GitHub Link: <a href="${project.additionalDetails.link}" target="_blank">${project.additionalDetails.link}</a></p>
                                <button class="btn btn-warning" onclick="editAdditionalDetails(${index})">Edit Details</button>
                            ` : ''}
                            <div id="add-detail-form-${index}" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            `).join("");  //function returns a string of HTML for each project, which join("") later combines into a single HTML string.
        }

        document.getElementById("form").addEventListener("submit", function (event) {
            event.preventDefault();  //preventing the page from reloading.

            const title = document.getElementById("title").value;
            const author = document.getElementById("author").value;
            const technologiesUsed = document.getElementById("technologiesUsed").value;
            const languageUsed = document.getElementById("languageUsed").value;
            const description = document.getElementById("description").value;
            const githubLink = document.getElementById("githubLink").value;
            const imageFile = document.getElementById("imageFile").files[0];

            const reader = new FileReader(); // asynchronously read the contents 
            reader.onload = function (e) {
                const imageSrc = e.target.result;
                const projects = JSON.parse(localStorage.getItem("projects")) || [];

                const project = {
                    title,
                    author,
                    technologiesUsed,
                    languageUsed,
                    description,
                    githubLink,
                    imageSrc,
                    additionalDetails: null // Initialize additionalDetails to null
                };

                if (editingIndex === null) {
                    projects.push(project);
                } else {
                    projects[editingIndex] = project; // Update the existing project
                }

                localStorage.setItem("projects", JSON.stringify(projects));
                loadProjects();
                hideProjectForm();
            };
            reader.readAsDataURL(imageFile);
        });

        function editProject(index) {
            const projects = JSON.parse(localStorage.getItem("projects"));
            const project = projects[index];

            document.getElementById("title").value = project.title;
            document.getElementById("author").value = project.author;
            document.getElementById("technologiesUsed").value = project.technologiesUsed;
            document.getElementById("languageUsed").value = project.languageUsed;
            document.getElementById("description").value = project.description;
            document.getElementById("githubLink").value = project.githubLink;

            // Hide the previous project form
            showProjectForm();
            editingIndex = index; // Set the index for editing
        }

        function deleteProject(index) {
            const projects = JSON.parse(localStorage.getItem("projects"));
            projects.splice(index, 1);
            localStorage.setItem("projects", JSON.stringify(projects));
            loadProjects();
        }

        // function addDetails(index) {
        //     const projectDetails = document.getElementById(`add-detail-form-${index}`);
        //     const detailsFormHtml = `
        //         <h4>Add Additional Project Details</h4>
        //         <div class="form-group">
        //             <label for="detailTitle">Detail Title:</label>
        //             <input type="text" id="detailTitle" class="form-control" required>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailAuthor">Author:</label>
        //             <input type="text" id="detailAuthor" class="form-control" required>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailTechnologiesUsed">Technologies Used:</label>
        //             <input type="text" id="detailTechnologiesUsed" class="form-control" required>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailLanguageUsed">Language Used:</label>
        //             <input type="text" id="detailLanguageUsed" class="form-control" required>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailImageFile">Image File:</label>
        //             <input type="file" id="detailImageFile" class="form-control" accept="image/*" required>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailDescription">Description:</label>
        //             <textarea id="detailDescription" class="form-control" required></textarea>
        //         </div>
        //         <div class="form-group">
        //             <label for="detailGithubLink">GitHub Link:</label>
        //             <input type="url" id="detailGithubLink" class="form-control" required>
        //         </div>
        //         <button class="btn btn-success" onclick="saveAdditionalDetails(${index})">Save Details</button>
        //     `;
        //     projectDetails.innerHTML = detailsFormHtml;
        //     projectDetails.style.display = "block"; // Show the additional details form
        // }

        function saveAdditionalDetails(index) {
            const detailTitle = document.getElementById("detailTitle").value;
            const detailAuthor = document.getElementById("detailAuthor").value;
            const detailTechnologiesUsed = document.getElementById("detailTechnologiesUsed").value;
            const detailLanguageUsed = document.getElementById("detailLanguageUsed").value;
            const detailDescription = document.getElementById("detailDescription").value;
            const detailGithubLink = document.getElementById("detailGithubLink").value;
            const detailImageFile = document.getElementById("detailImageFile").files[0];

            const reader = new FileReader();
            reader.onload = function (e) {
                const imageUrl = e.target.result;
                const projects = JSON.parse(localStorage.getItem("projects"));
                const project = projects[index];

                project.additionalDetails = {
                    detailTitle,
                    author: detailAuthor,
                    technologiesUsed: detailTechnologiesUsed,
                    languageUsed: detailLanguageUsed,
                    description: detailDescription,
                    link: detailGithubLink,
                    imageUrl
                };

                localStorage.setItem("projects", JSON.stringify(projects));
                loadProjects();
            };
            reader.readAsDataURL(detailImageFile);
        }

        function toggleDetails(index) {
            const details = document.getElementById(`additional-details-${index}`);
            details.style.display = details.style.display === "none" ? "block" : "none";
        }

        window.onload = loadProjects;
    </script>
    <!-- <script src="port.js"></script> -->
</body>
</html>
